<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Acertando nas Compras â€” Pedido de Busca de PreÃ§os</title>
<meta name="description" content="PeÃ§a uma busca de preÃ§os personalizada nos maiores marketplaces. ServiÃ§o gratuito que ajuda vocÃª a economizar." />
<style>
  :root{
    --primary:#1653C0; --primary-600:#0F47A8; --accent:#E53935;
    --bg:#F5F7FB; --panel:#FFFFFF; --muted:#64748B; --text:#0F172A;
    --ring:#C7D2FE; --ok:#16A34A; --shadow:0 10px 28px rgba(16,24,40,.10);
    --radius:18px; --soft:#EEF2FF; --softbd:#DFE7FF;
  }
  *{box-sizing:border-box}
  html,body{height:100%}
  body{
    margin:0; color:var(--text);
    font-family:Inter, system-ui, Segoe UI, Roboto, Arial, sans-serif;
    background:radial-gradient(1100px 520px at 85% -10%, rgba(22,83,192,.06), transparent 60%) var(--bg);
    -webkit-font-smoothing:antialiased; text-rendering:optimizeLegibility;
    line-height:1.45;
  }
  .container{max-width:1200px;margin:28px auto;padding:0 20px}

  header{display:flex;gap:16px;align-items:center;margin-bottom:20px}
  header img{width:72px;height:72px;object-fit:contain;border-radius:14px;background:#0B3E9B10;box-shadow:0 8px 18px rgba(22,83,192,.18)}
  h1{font-size:clamp(22px,2.6vw,36px);margin:0;line-height:1.1}
  .subtitle{color:var(--muted);margin-top:6px;font-size:clamp(14px,1.8vw,16px)}

  .hero{background:linear-gradient(180deg,#FFF 0%,#F9FBFF 100%);border:1px solid #EDF2FF;border-radius:var(--radius);box-shadow:var(--shadow);padding:20px;margin-bottom:22px;display:grid;gap:12px}
  .badges{display:flex;gap:10px;flex-wrap:wrap}
  .badge{background:#EEF2FF;color:#22336B;border:1px solid #DFE7FF;padding:7px 12px;border-radius:999px;font-size:12px;font-weight:700}

  form{background:var(--panel);border:1px solid #E5E7EB;border-radius:var(--radius);box-shadow:var(--shadow);padding:22px;display:grid;gap:22px}

  /* ===== GRID UTIL ===== */
  .grid{display:grid;gap:14px;grid-template-columns:repeat(12,1fr)}
  .grid > *{min-width:0} /* evita empurrar vizinhos */
  .col-12{grid-column:span 12}
  .col-6{grid-column:span 12}
  .col-4{grid-column:span 12}
  .col-3{grid-column:span 12}
  @media (min-width:760px){
    .col-6{grid-column:span 6}
    .col-4{grid-column:span 4}
    .col-3{grid-column:span 3}
  }

  label{display:block;font-weight:700;margin-bottom:6px}
  .help{color:var(--muted);font-size:12px;margin-top:6px}

  input[type="text"],input[type="email"],input[type="tel"],input[type="number"],input[type="url"],textarea,select{
    width:100%;padding:13px 14px;border-radius:14px;border:1px solid #E5E7EB;background:#FFF;color:var(--text);outline:none;transition:.15s ease;font-size:15px}
  input:focus,textarea:focus,select:focus{border-color:var(--primary);box-shadow:0 0 0 4px var(--ring)}
  textarea{min-height:120px;resize:vertical}

  .row-inline{display:flex;gap:10px;align-items:center;flex-wrap:wrap}
  .chip{border:1px solid #E5E7EB;padding:9px 12px;border-radius:999px;background:#FFF;cursor:pointer;user-select:none}
  .chip input{display:none}
  .chip.active{border-color:var(--primary);background:#F5F8FF;color:#0F2A63}

  /* === PRODUTOS === */
  #produtosWrap{display:grid;gap:16px;grid-template-columns:1fr}
  @media (min-width:760px){#produtosWrap{grid-template-columns:1fr 1fr}}
  @media (min-width:1100px){#produtosWrap{grid-template-columns:1fr 1fr 1fr}}
  .produto-card{border:1px solid #E5E7EB;border-radius:16px;padding:16px;background:#FFF;box-shadow:0 8px 18px rgba(2,6,23,.04)}
  .produto-head{display:flex;align-items:center;justify-content:space-between;margin-bottom:10px}
  .tag{font-size:12px;background:var(--soft);border:1px solid var(--softbd);padding:5px 10px;border-radius:999px;font-weight:800;color:#22336B}
  .remove{background:#FFF;color:#B91C1C;border:1px solid #FECACA}
  .add-product{border:1px dashed #BFD0FF;background:#F6F9FF;color:#123A8C;width:100%}
  @media (min-width:760px){.add-product{width:auto}}

  /* === DADOS DO CLIENTE (auto-fit evita sobreposiÃ§Ã£o) === */
  .cliente{
    display:grid; gap:14px;
    grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
    align-items:start;
  }
  .cliente > *{min-width:0}

  /* === AÃ‡Ã•ES === */
  .actions{display:flex;gap:12px;flex-wrap:wrap;align-items:center;border-top:1px dashed #E5E7EB;padding-top:16px}
  .actions{grid-column:1/-1}
  .btn{appearance:none;border:none;cursor:pointer;font-weight:800;padding:13px 18px;border-radius:14px;display:inline-flex;align-items:center;gap:10px;text-decoration:none}
  .btn-primary{background:var(--primary);color:#fff}.btn-primary:hover{background:var(--primary-600)}
  .btn-ghost{background:#F3F4F6;color:#111827}.btn-accent{background:var(--accent);color:#fff}.btn-ok{background:var(--ok);color:#fff}
  @media (max-width:480px){.actions .btn{flex:1 1 100%}}

  .toast{position:fixed;inset-inline:0;bottom:18px;margin-inline:auto;max-width:620px;background:#111827;color:#fff;padding:13px 14px;border-radius:14px;box-shadow:var(--shadow);display:none}
  footer{margin:24px 0 42px;color:var(--muted);font-size:13px;text-align:center}
  footer a{color:var(--primary-600);font-weight:700;text-decoration:none}
</style>
</head>
<body>
  <div class="container">
    <header>
      <img src="img/logo.jpeg" alt="Logo Acertando nas Compras" />
      <div>
        <h1>Acertando nas Compras</h1>
        <div class="subtitle">Busca de preÃ§os personalizada nos maiores marketplaces â€” <strong>grÃ¡tis</strong> e focada em economia.</div>
      </div>
    </header>

    <section class="hero">
      <div class="badges">
        <span class="badge">Amazon â€¢ Magalu â€¢ Mercado Livre â€¢ Outros</span>
        <span class="badge">Produtos originais e bem avaliados</span>
        <span class="badge">ComparaÃ§Ã£o transparente</span>
        <span class="badge">WhatsApp e E-mail</span>
      </div>
      <p class="help">ðŸ’¡ Adicione os produtos que deseja que busquemos e te enviaremos as melhores ofertas</p>
    </section>

    <form id="pedidoForm" novalidate>
      <!-- PRODUTOS -->
      <div class="col-12">
        <label>Produtos desejados</label>
        <div id="produtosWrap"></div>
        <button type="button" id="btnAddProduto" class="btn add-product" style="margin-top:10px">+ Adicionar outro produto</button>
      </div>

      <!-- PREFERÃŠNCIAS GERAIS -->
      <div class="grid">
        <div class="col-12">
          <label>PreferÃªncia de marketplace</label>
          <div class="row-inline">
            <label class="chip"><input type="checkbox" name="marketplaces" value="Amazon" />Amazon</label>
            <label class="chip"><input type="checkbox" name="marketplaces" value="Magazine Luiza" />Magalu</label>
            <label class="chip"><input type="checkbox" name="marketplaces" value="Mercado Livre" />Mercado Livre</label>
            <label class="chip"><input type="checkbox" name="marketplaces" value="Outros" />Outros</label>
          </div>
        </div>
        <div class="col-6">
          <label>UrgÃªncia do pedido</label>
          <div class="row-inline" id="urgenciaChips">
            <label class="chip"><input type="radio" name="urgencia" value="Hoje" />Hoje</label>
            <label class="chip"><input type="radio" name="urgencia" value="Esta semana" />Esta semana</label>
            <label class="chip"><input type="radio" name="urgencia" value="Este mÃªs" />Este mÃªs</label>
            <label class="chip"><input type="radio" name="urgencia" value="Sem pressa" />Sem pressa</label>
          </div>
        </div>
        <div class="col-12">
          <label for="observacoesGerais">ObservaÃ§Ãµes gerais</label>
          <textarea id="observacoesGerais" placeholder="Ex.: evitar vendedor internacional, prefere retirada na loja, etc."></textarea>
        </div>
      </div>

      <!-- DADOS DO CLIENTE -->
      <div class="cliente">
        <div>
          <label for="nome">Seu nome</label>
          <input id="nome" placeholder="Como devemos te chamar?" required />
        </div>
        <div>
          <label for="email">E-mail (opcional)</label>
          <input id="email" type="email" placeholder="seuemail@exemplo.com" />
        </div>
        <div>
          <label for="telefone">WhatsApp/Telefone</label>
          <input id="telefone" placeholder="(14) 99700-7069" required />
        </div>
        <div>
          <label for="cep">CEP da cidade</label>
          <input id="cep" placeholder="17500-000" required />
        </div>
        <div style="grid-column:1/-1">
          <label class="row-inline" style="gap:8px">
            <input id="consent" type="checkbox" required />
            <span>Autorizo o contato para receber as melhores ofertas e comparativos.</span>
          </label>
        </div>
      </div>

      <!-- AÃ‡Ã•ES -->
      <div class="actions">
        <button type="button" class="btn btn-primary" id="btnWhats">Enviar via WhatsApp</button>
        <a href="#" class="btn btn-accent" id="btnEmail">Enviar por E-mail</a>
        <button type="button" class="btn btn-ok" id="btnSalvar">Salvar rascunho</button>
        <button type="reset" class="btn btn-ghost" id="btnLimpar">Limpar</button>
      </div>
    </form>

    <footer>
      Â© <span id="year"></span> Acertando nas Compras â€” ServiÃ§o gratuito de curadoria de ofertas.  
      Desenvolvido para MarÃ­lia/SP â€¢ Contato: <a href="https://wa.me/5514997007069" target="_blank" rel="noopener">WhatsApp</a>
    </footer>
  </div>

  <div id="toast" class="toast" role="status"></div>

  <!-- Template do produto -->
  <template id="produtoTpl">
    <div class="produto-card" data-produto>
      <div class="produto-head">
        <span class="tag">Produto <span class="idx">1</span></span>
        <button type="button" class="btn remove" data-remover>Remover</button>
      </div>
      <div class="grid">
        <div class="col-12">
          <label>O que vocÃª quer?</label>
          <input data-campo="nome" required placeholder="Ex.: Smart TV 50'', Notebook i5, Ar-condicionado 9.000 BTUâ€¦" />
          <div class="help">Descreva modelo, cor, voltagem, tamanho, etc.</div>
        </div>
        <div class="col-6">
          <label>Marca preferida (opcional)</label>
          <input data-campo="marca" placeholder="Ex.: Samsung, Philips, LGâ€¦" />
        </div>
        <div class="col-3">
          <label>Quantidade</label>
          <input data-campo="quantidade" type="number" min="1" step="1" value="1" />
        </div>
        <div class="col-3">
          <label>CondiÃ§Ã£o</label>
          <select data-campo="condicao">
            <option value="novo" selected>Novo</option>
            <option value="usado">Usado</option>
            <option value="ambos">Novo ou usado</option>
          </select>
        </div>
        <div class="col-6">
          <label>OrÃ§amento mÃ¡ximo (R$)</label>
          <input data-campo="orcamento" inputmode="decimal" placeholder="Ex.: 2500,00" />
        </div>
        <div class="col-6">
          <label>Links de referÃªncia (opcional)</label>
          <input data-campo="links" type="url" placeholder="Cole links (separe por espaÃ§o ou vÃ­rgula)" />
        </div>
        <div class="col-12">
          <label>ObservaÃ§Ãµes (opcional)</label>
          <textarea data-campo="obs" placeholder="Ex.: precisa ser bivolt, suporte VESA 200x200, etc."></textarea>
        </div>
      </div>
    </div>
  </template>

<script>
  // ---------- Helpers
  const $=(s,p=document)=>p.querySelector(s); const $$=(s,p=document)=>[...p.querySelectorAll(s)];
  const toast = (msg)=>{ const el=$("#toast"); el.textContent=msg; el.style.display='block'; setTimeout(()=>el.style.display='none',2400); };
  const SEU_WHATS="5514997007069"; const FORM_KEY="acertando-form-v4";
  const produtosWrap=$("#produtosWrap"); const produtoTpl=$("#produtoTpl").content;

  // ---------- MÃ¡scaras
  const maskTel=v=>v.replace(/\D/g,'').replace(/^(\d)/,'($1').replace(/^\((\d{2})(\d)/,'($1) $2').replace(/(\d{5})(\d{4}).*/,'$1-$2');
  const maskCEP=v=>v.replace(/\D/g,'').replace(/(\d{5})(\d{3}).*/,'$1-$2');
  $("#telefone").addEventListener('input',e=>e.target.value=maskTel(e.target.value));
  $("#cep").addEventListener('input',e=>e.target.value=maskCEP(e.target.value));

  // ---------- Chips
  $$("#urgenciaChips .chip").forEach(ch=>{
    ch.addEventListener('click',()=>{
      $$('#urgenciaChips .chip').forEach(c=>c.classList.remove('active'));
      ch.classList.add('active'); ch.querySelector('input').checked=true;
    });
  });
  $$(".chip input[type=checkbox]").forEach(inp=>{
    const wrap=inp.closest('.chip'); wrap.addEventListener('click',()=>wrap.classList.toggle('active'));
  });

  // ---------- Produtos dinÃ¢micos
  function renumerarProdutos(){ $$("#produtosWrap [data-produto]").forEach((c,i)=>c.querySelector('.idx').textContent=i+1); }
  function bindProdutoCard(card){
    card.querySelector('[data-remover]').addEventListener('click',()=>{
      if($$("#produtosWrap [data-produto]").length<=1){ toast("Mantenha ao menos 1 produto."); return; }
      card.remove(); renumerarProdutos(); saveDraft(true);
    });
    card.querySelector('[data-campo="orcamento"]').addEventListener('input',e=>{
      e.target.value = e.target.value.replace(/[^\d.,]/g,'').replace(/,/g,'.'); // aceita vÃ­rgula ou ponto
    });
  }
  function addProduto(data={}){
    const node=produtoTpl.cloneNode(true); produtosWrap.appendChild(node);
    const card=produtosWrap.lastElementChild; bindProdutoCard(card);
    card.querySelector('[data-campo="nome"]').value = data.nome||'';
    card.querySelector('[data-campo="marca"]').value = data.marca||'';
    card.querySelector('[data-campo="quantidade"]').value = data.quantidade||'1';
    card.querySelector('[data-campo="condicao"]').value = data.condicao||'novo';
    card.querySelector('[data-campo="orcamento"]').value = data.orcamento||'';
    card.querySelector('[data-campo="links"]').value = data.links||'';
    card.querySelector('[data-campo="obs"]').value = data.obs||'';
    renumerarProdutos();
  }
  $("#btnAddProduto").addEventListener('click', ()=>{ addProduto(); saveDraft(true); });

  // ---------- Coleta/rascunho
  const collectMarketplaces=()=>$$('input[name="marketplaces"]:checked').map(cb=>cb.value);
  const collectProdutos=()=>$$('#produtosWrap [data-produto]').map(card=>({
    nome:card.querySelector('[data-campo="nome"]').value.trim(),
    marca:card.querySelector('[data-campo="marca"]').value.trim(),
    quantidade:card.querySelector('[data-campo="quantidade"]').value.trim()||'1',
    condicao:card.querySelector('[data-campo="condicao"]').value,
    orcamento:card.querySelector('[data-campo="orcamento"]').value.trim(),
    links:card.querySelector('[data-campo="links"]').value.trim(),
    obs:card.querySelector('[data-campo="obs"]').value.trim(),
  }));
  function collectAll(){
    return {
      produtos: collectProdutos(),
      marketplaces: collectMarketplaces(),
      urgencia: $('input[name="urgencia"]:checked')?.value || '',
      observacoesGerais: $("#observacoesGerais").value.trim(),
      nome: $("#nome").value.trim(),
      email: $("#email").value.trim(), // opcional
      telefone: $("#telefone").value.trim(),
      cep: $("#cep").value.trim(),
      consent: $("#consent").checked
    };
  }
  function saveDraft(silent=false){ localStorage.setItem(FORM_KEY, JSON.stringify(collectAll())); if(!silent) toast("Rascunho salvo."); }
  function loadDraft(){
    const raw=localStorage.getItem(FORM_KEY);
    if(!raw){ addProduto(); return; }
    const d=JSON.parse(raw);
    produtosWrap.innerHTML='';
    (d.produtos?.length? d.produtos : [{}]).forEach(p=>addProduto(p));
    $$('input[name="marketplaces"]').forEach(cb=>{
      cb.checked = d.marketplaces?.includes(cb.value) || false;
      cb.checked ? cb.closest('.chip').classList.add('active') : cb.closest('.chip').classList.remove('active');
    });
    if(d.urgencia){ const r=$(`#urgenciaChips input[value="${d.urgencia}"]`); if(r){ r.checked=true; r.closest('.chip').classList.add('active'); } }
    $("#observacoesGerais").value=d.observacoesGerais||'';
    $("#nome").value=d.nome||''; $("#email").value=d.email||''; $("#telefone").value=d.telefone||''; $("#cep").value=d.cep||'';
    $("#consent").checked=!!d.consent;
  }
  function clearDraft(){ localStorage.removeItem(FORM_KEY); }

  // ---------- ValidaÃ§Ã£o & resumo
  function validate(){
    // e-mail Ã© OPCIONAL; se preenchido, o type="email" jÃ¡ valida formato
    const baseOk = $("#nome").checkValidity() && $("#telefone").checkValidity() && $("#cep").checkValidity() && $("#consent").checked;
    if(!baseOk){
      $("#pedidoForm").reportValidity();
      if(!$("#consent").checked) toast("Ã‰ preciso autorizar o contato.");
      return false;
    }
    const produtos=collectProdutos().filter(p=>p.nome.length>0);
    if(produtos.length===0){ toast("Adicione pelo menos 1 produto."); return false; }
    const inval=produtos.find(p=> isNaN(parseInt(p.quantidade)) || parseInt(p.quantidade)<1 );
    if(inval){ toast("Verifique as quantidades dos produtos."); return false; }
    return true;
  }
  function buildSummary(d){
    const linhas=[];
    linhas.push(`ðŸ›’ *Pedido de Busca de PreÃ§os* â€” Acertando nas Compras`);
    d.produtos.forEach((p,i)=>{
      if(!p.nome) return;
      linhas.push(`\n*Produto ${i+1}*`);
      linhas.push(`â€¢ Item: ${p.nome}`);
      if(p.marca) linhas.push(`â€¢ Marca preferida: ${p.marca}`);
      linhas.push(`â€¢ Quantidade: ${p.quantidade} â€¢ CondiÃ§Ã£o: ${p.condicao}`);
      if(p.orcamento) linhas.push(`â€¢ OrÃ§amento mÃ¡x.: R$ ${p.orcamento}`);
      if(p.links) linhas.push(`â€¢ Links ref.: ${p.links}`);
      if(p.obs) linhas.push(`â€¢ ObservaÃ§Ãµes: ${p.obs}`);
    });
    if(d.marketplaces.length) linhas.push(`\nâ€¢ Marketplaces preferidos: ${d.marketplaces.join(', ')}`);
    if(d.urgencia) linhas.push(`â€¢ UrgÃªncia: ${d.urgencia}`);
    if(d.observacoesGerais) linhas.push(`â€¢ ObservaÃ§Ãµes gerais: ${d.observacoesGerais}`);
    linhas.push(`\nâ€” Dados do cliente â€”`);
    linhas.push(`â€¢ Nome: ${d.nome}`);
    linhas.push(`â€¢ WhatsApp/Tel.: ${d.telefone}`);
    if(d.email) linhas.push(`â€¢ E-mail: ${d.email}`);
    linhas.push(`â€¢ CEP: ${d.cep}`);
    linhas.push(`(Consentimento de contato: ${d.consent ? 'Sim' : 'NÃ£o'})`);
    return linhas.join('\n');
  }

  // ---------- AÃ§Ãµes
  $("#btnSalvar").addEventListener('click',()=>saveDraft());
  $("#btnLimpar").addEventListener('click',()=>{ clearDraft(); toast("FormulÃ¡rio limpo."); produtosWrap.innerHTML=''; addProduto(); });
  $("#btnWhats").addEventListener('click',()=>{
    if(!validate()) return;
    const d=collectAll(); const msg=buildSummary(d);
    window.open(`https://wa.me/${SEU_WHATS}?text=${encodeURIComponent(msg)}`,'_blank','noopener');
    saveDraft(true);
  });
  $("#btnEmail").addEventListener('click',(e)=>{
    e.preventDefault();
    if(!validate()) return;
    const d=collectAll();
    const assunto=`Pedido de busca (${d.produtos.length} produto${d.produtos.length>1?'s':''}) â€” ${d.nome}`;
    const corpo=buildSummary(d);
    window.location.href=`mailto:contato@acertandonascompras.com?subject=${encodeURIComponent(assunto)}&body=${encodeURIComponent(corpo)}`;
    saveDraft(true);
  });

  // ---------- Init
  $("#btnAddProduto").addEventListener('click', ()=>{ addProduto(); saveDraft(true); });
  loadDraft();
  $("#year").textContent=new Date().getFullYear();
</script>
</body>
</html>
